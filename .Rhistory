export_data <- cbind(export_data, trackid = accounts$track_id, empty_col)
export_data <- cbind(export_data, trackdomain = accounts$trackdomain, reporting_server = accounts$webhost, cluster = accounts$raw_data)
export_data <- cbind(export_data, aggregation = accounts$aggregation, transformer = accounts$transformer)
export_data$trackid <- as.character(export_data$trackid)
export_data$trackdomain <- as.character(export_data$trackdomain)
export_data$reporting_server <- as.character(export_data$reporting_server)
export_data$cluster <- as.character(export_data$cluster)
export_data$aggregation <- as.character(export_data$aggregation)
export_data$transformer <- as.character(export_data$transformer)
export_data$account <- gsub(" $", "", export_data$account)
shortlist = c("yoox-italia", "youmob-italia", "wolterskluwer-italia")
export_data <- filter(export_data, account %in% shortlist)
export_data$reporting_server <- gsub("report", "", export_data$reporting_server)
export_data$reporting_server <- gsub(".webtrekk.com ", "", export_data$reporting_server)
export_data$cluster <- gsub(" $", "", export_data$cluster)
export_data$aggregation <- gsub(" $", "", export_data$aggregation)
export_data$transformer <- gsub("transformer", "", export_data$transformer)
export_data$transformer <- gsub(" $", "", export_data$transformer)
export_data$trackdomain <- gsub(" $", "", export_data$trackdomain)
str(export_data)
do_export_data <- function() {
empty_col <- data.frame(a = rep("", nrow(accounts)), b = rep("", nrow(accounts)), c = rep("", nrow(accounts)), d = rep("", nrow(accounts)), e = rep("", nrow(accounts)), f = rep("", nrow(accounts)), stringsAsFactors = F)
export_data <- data.frame(account = accounts$account, stringsAsFactors = F)
export_data <- cbind(export_data, trackid = accounts$track_id, empty_col)
export_data <- cbind(export_data, trackdomain = accounts$trackdomain, reporting_server = accounts$webhost, cluster = accounts$raw_data)
export_data <- cbind(export_data, aggregation = accounts$aggregation, transformer = accounts$transformer)
export_data$trackid <- as.character(export_data$trackid)
export_data$trackdomain <- as.character(export_data$trackdomain)
export_data$reporting_server <- as.character(export_data$reporting_server)
export_data$cluster <- as.character(export_data$cluster)
export_data$aggregation <- as.character(export_data$aggregation)
export_data$transformer <- as.character(export_data$transformer)
export_data$account <- gsub(" $", "", export_data$account)
shortlist = c("yoox-italia", "iumob-italia", "wolterskluwer-italia", "carabinieri-italia")
export_data <- filter(export_data, account %in% shortlist)
export_data$reporting_server <- gsub("report", "", export_data$reporting_server)
export_data$reporting_server <- gsub(".webtrekk.com ", "", export_data$reporting_server)
export_data$cluster <- gsub(" $", "", export_data$cluster)
export_data$aggregation <- gsub(" $", "", export_data$aggregation)
export_data$transformer <- gsub("transformer", "", export_data$transformer)
export_data$transformer <- gsub(" $", "", export_data$transformer)
export_data$trackdomain <- gsub(" $", "", export_data$trackdomain)
write.table(export_data, "exported_accounts_list.csv", quote = T, sep = ";", row.names = F)
}
do_export_data()
shortlist = c("softec-italia","gruppopa-italia","Adventure4You Italia","dolcitalia-italia","nanabianca-italia","indabox-italia","acmilan-italia","e-interiors-italia","finmeccanica-italia","gazzettadiparma-italia","luxottica-italia","1604lab-italia","Classeditori")
do_export_data()
shortlist = c("softec-italia","gruppopa-italia","Adventure4You Italia","dolcitalia-italia","nanabianca-italia","indabox-italia","acmilan-italia","e-interiors-italia","finmeccanica-italia","gazzettadiparma-italia","luxottica-italia","1604lab-italia","Classeditori")
do_export_data()
shortlist
do_export_data()
do_export_data <- function() {
empty_col <- data.frame(a = rep("", nrow(accounts)), b = rep("", nrow(accounts)), c = rep("", nrow(accounts)), d = rep("", nrow(accounts)), e = rep("", nrow(accounts)), f = rep("", nrow(accounts)), stringsAsFactors = F)
export_data <- data.frame(account = accounts$account, stringsAsFactors = F)
export_data <- cbind(export_data, trackid = accounts$track_id, empty_col)
export_data <- cbind(export_data, trackdomain = accounts$trackdomain, reporting_server = accounts$webhost, cluster = accounts$raw_data)
export_data <- cbind(export_data, aggregation = accounts$aggregation, transformer = accounts$transformer)
export_data$trackid <- as.character(export_data$trackid)
export_data$trackdomain <- as.character(export_data$trackdomain)
export_data$reporting_server <- as.character(export_data$reporting_server)
export_data$cluster <- as.character(export_data$cluster)
export_data$aggregation <- as.character(export_data$aggregation)
export_data$transformer <- as.character(export_data$transformer)
export_data$account <- gsub(" $", "", export_data$account)
export_data <- filter(export_data, account %in% shortlist)
export_data$reporting_server <- gsub("report", "", export_data$reporting_server)
export_data$reporting_server <- gsub(".webtrekk.com ", "", export_data$reporting_server)
export_data$cluster <- gsub(" $", "", export_data$cluster)
export_data$aggregation <- gsub(" $", "", export_data$aggregation)
export_data$transformer <- gsub("transformer", "", export_data$transformer)
export_data$transformer <- gsub(" $", "", export_data$transformer)
export_data$trackdomain <- gsub(" $", "", export_data$trackdomain)
write.table(export_data, "exported_accounts_list.csv", quote = T, sep = ";", row.names = F)
}
do_export_data()
shortlist = c("3bmeteo-italia","aspiag-italia","Caltagirone-Editore-italia","condenast-italia","contactlab-italia-sandbox","databiz-italia","DeAgostini-italia","Edimotive-Italia","Findsdm-italia","Gruner_Jahr/Mondadori-italia","GruppoFinelco-italia","Hearst Magazine Italia","ilfattoquotidiano-italia","infinity-italia","Intranet IFIS Italia","lasicilia-italia","linear-italia","marcopoloshop-italia","maxus-italia","mcdonalds-italia","moto-italia","NTV-italia","Radio-Italia","rai-italia","rockol-italia","shoped-italia","shop-ilgazzettino-italia","shoppydoo-italia","Siti Esterni IFIS Italia","spaziorelax-italia","ufficiodiscount-italia","Webranking-italia-sandbox")
do_export_data()
rm(list=ls())
setwd("C:/Users/User/Dropbox/R-Folder/RepRes/RepData_PeerAssessment2")
source("expl_code_001.R")
View(storm_data)
source("expl_code_001.R")
# Then I read the data into R and assign it to a data frame
writeLines("\nReading the data into R, please wait. This operation could take a while.\n")
storm_data <- read.csv("Data/storm_data.csv.bz2", header = T, stringsAsFactors = T)
# Freeing up some memory.
do_collect_garbage()
# To make the analyses lighter, I will remove some information that is not relevant to the assignment.
writeLines("\nSubsetting the data to free up memory\n")
subset <- select(storm_data, BGN_DATE, EVTYPE, MAG, FATALITIES, INJURIES, PROPDMG, PROPDMGEXP, CROPDMG, CROPDMGEXP)
rm(storm_data)
do_collect_garbage()
str(subset)
evtypes_dmg <- aggregate(x = (subset[, "PROPDMG"] + subset[, "CROPDMG"] + subset[, "INJURIES"] + subset[, "FATALITIES"]), by = list(subset[, "EVTYPE"]), FUN = "sum")
evtypes_dmg2 <- aggregate(x = (subset[, "PROPDMG"] + subset[, "CROPDMG"]), by = list(subset[, "EVTYPE"]), FUN = "sum")
irrelevant_evtypes <- filter(evtypes_dmg, x == 0) %>% select(Group.1)
irrelevant_evtypes2 <- filter(evtypes_dmg2, x == 0) %>% select(Group.1)
rm(irrelevant_evtypes)
rm(irrelevant_evtypes2)
rm(evtypes_dmg)
rm(evtypes_dmg2)
gc()
gc()
gc()
# The harmfulness can be computed in several ways:
# - frequency (probability of the event);
# - damage (mean and median for single events);
# - total damage (sum for event type).
# I clean up the data set by removing irrelevant event types (with zero aggregated damage)
writeLines("\nSubsetting even more to get rid of inconsequential events.\n")
evtypes_dmg <- aggregate(x = (subset[, "PROPDMG"] + subset[, "CROPDMG"] + subset[, "INJURIES"] + subset[, "FATALITIES"]), by = list(subset[, "EVTYPE"]), FUN = "sum")
irrelevant_evtypes <- filter(evtypes_dmg, x == 0) %>% select(Group.1)
subset <- filter(subset, !(EVTYPE %in% unlist(irrelevant_evtypes)))
subset <- droplevels(subset)
do_collect_garbage()
# I tidy up the name of the unknown values.
subset$EVTYPE <- plyr::revalue(subset$EVTYPE, c("?"="UNKNOWN"))
# How many EVTYPES are there with this pattern?
length(grep(".*TSTM.*", levels(subset$EVTYPE)))
correct_event_types <- c("Astronomical Low Tide", "Avalanche", "Blizzard", "Coastal Flood", "Cold/Wind Chill", "Debris Flow", "Dense Fog", "Dense Smoke", "Drought", "Dust Devil", "Dust Storm", "Excessive Heat", "Extreme Cold/Wind Chill", "Flash Flood", "Flood", "Freezing Fog", "Frost/Freeze", "Funnel Cloud", "Hail", "Heat", "Heavy Rain", "Heavy Snow", "High Surf", "High Wind", "Hurricane/Typhoon", "Ice Storm", "Lakeshore Flood", "Lake-Effect Snow", "Lightning", "Marine Hail", "Marine High Wind", "Marine Strong Wind", "Marine Thunderstorm Wind", "Rip Current", "Seiche", "Sleet", "Storm Tide", "Strong Wind", "Thunderstorm Wind", "Tornado", "Tropical Depression", "Tropical Storm", "Tsunami", "Volcanic Ash", "Waterspout", "Wildfire", "Winter Storm", "Winter Weather")
length(correct_event_types)
levels(subset$EVTYPE)
grep("hail", levels(subset$EVTYPE), value = T)
grep("hail", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("tornado", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("waterspout", levels(subset$EVTYPE), value = T, ignore.case = T)
gsub(".*waterspout.*", "WATERSPOUT", levels(subset$EVTYPE), value = T, ignore.case = T)
gsub(".*waterspout.*", "WATERSPOUT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*waterspout.*", "WATERSPOUT", levels(subset$EVTYPE), ignore.case = T)
grep("waterspout", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("tornado", levels(subset$EVTYPE), value = T, ignore.case = T)
correct_event_types
grep("tornado", levels(subset$EVTYPE), value = T, ignore.case = T)
subset <- droplevels(subset)
length(levels(subset$EVTYPE))
levels(subset$EVTYPE)<- gsub(".*tornado.*", "TORNADO", levels(subset$EVTYPE), ignore.case = T)
grep("hail", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("thunderstorm", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("^thunder.*hail", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("^thunderstorm hail", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("^thunderstorm hail$", "HAIL", levels(subset$EVTYPE), ignore.case = T)
grep("thunderstorm", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("hail", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("^thunderstorm", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("^thunderstorm.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("^thunderstorm", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("thunderstorm", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("^lightning.*thunderstorm.*", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("^lightning.*thunderstorm.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("thunderstorm", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("^severe.*thunderstorm.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("thunderstorm", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("hail", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("tstm", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("^tstm.*", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("^tstm.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("tstm", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("^ tstm.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("tstm", levels(subset$EVTYPE), value = T, ignore.case = T)
subset <- droplevels(subset)
length(levels(subset$EVTYPE))
grep("hail", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*hail.*", "HAIL", levels(subset$EVTYPE), ignore.case = T)
grep("hail", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("marine", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("MARINE TSTM WIND", "MARINE THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("marine", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("storm", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("thun", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("^thun", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("^thun.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("^thun", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("storm", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("blizzard", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("avalanche", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".avalanche.*", "AVALANCHE", levels(subset$EVTYPE), ignore.case = T)
grep("avalanche", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*avalanche.*", "AVALANCHE", levels(subset$EVTYPE), ignore.case = T)
grep("avalanche", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("blizzard", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*blizzard.*", "BLIZZARD", levels(subset$EVTYPE), ignore.case = T)
grep("blizzard", levels(subset$EVTYPE), value = T, ignore.case = T)
subset <- droplevels(subset)
length(levels(subset$EVTYPE))
grep("storm", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("storm", correct_event_types, value = T, ignore.case = T)
grep(".*dust storm.*", levels(subset$EVTYPE), value = T, ignore.case = T)
grep(".*storm tide.*", levels(subset$EVTYPE), value = T, ignore.case = T)
grep(".*ice storm.*", levels(subset$EVTYPE), value = T, ignore.case = T)
grep(".*ice storm$", levels(subset$EVTYPE), value = T, ignore.case = T)
grep(".*winter storm.*", levels(subset$EVTYPE), value = T, ignore.case = T)
grep(".*tropical storm.*", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("flood", correct_event_types, value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*dust storm.*", "DUST STORM", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*ice storm$", "ICE STORM", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*winter storm.*", "WINTER STORM", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*tropical storm.*", "TROPICAL STORM", levels(subset$EVTYPE), ignore.case = T)
grep("storm", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("flash flood", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*flash flood.*", "FLASH FLOOD", levels(subset$EVTYPE), ignore.case = T)
grep("flash flood", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("flood", correct_event_types, value = T, ignore.case = T)
grep("flood", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("lake.*flood", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*coastal flood.*", "COASTAL FLOOD", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*lake.*flood.*", "COASTAL FLOOD", levels(subset$EVTYPE), ignore.case = T)
grep("lake.*flood", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("flood", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("coast.*flood", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*coast.*flood.*", "COASTAL FLOOD", levels(subset$EVTYPE), ignore.case = T)
grep("flood", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("flood", correct_event_types, value = T, ignore.case = T)
grep("flash.*flood", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*flash.*flood.*", "FLASH FLOOD", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*cstl.*flood.*", "COASTAL FLOOD", levels(subset$EVTYPE), ignore.case = T)
grep("flood", correct_event_types, value = T, ignore.case = T)
grep("flood", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*flood.*flash.*", "FLASH FLOOD", levels(subset$EVTYPE), ignore.case = T)
grep("flood", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("mud", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("mud", correct_event_types, value = T, ignore.case = T)
grep("slide", correct_event_types, value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*mud.*", "MUDSLIDES", levels(subset$EVTYPE), ignore.case = T)
grep("mud", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("flood", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*flash.*flood.*", "FLASH FLOOkD", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*flood.*flash.*", "FLASH FLOOkD", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*coast.*flood.*", "COASTAL FLOOkD", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*cstl.*flood.*", "COASTAL FLOODk", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*lake.*flood.*", "LAKESHORE FLOOkD", levels(subset$EVTYPE), ignore.case = T)
grep("flood", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*cstl.*flood.*", "COASTAL FLOOkD", levels(subset$EVTYPE), ignore.case = T)
grep("flood", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("flookd", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*flood.*", "FLOOD", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("FLASH FLOOKD", "FLASH FLOOD", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("COASTAL FLOOKD", "COASTAL FLOOD", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("LAKESHORE FLOOKD", "LAKESHORE FLOOD", levels(subset$EVTYPE), ignore.case = T)
# And I drop the unused ones.
subset <- droplevels(subset)
# Finally I clean up some memory
do_collect_garbage()
length(levels(subset$EVTYPE))
source("expl_code_001.R")
list(subset$EVTYPE)
levels(subset$EVTYPE)
correct_event_types
grep("devil", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("dev", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("dust", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*devil.*", "DUST DEVIL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("BLOWING DUST", "DUST STORM", levels(subset$EVTYPE), ignore.case = T)
grep("drought", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("heat", levels(subset$EVTYPE), value = T, ignore.case = T)
grep(".+heat", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("^heat.*", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*devil.*", "DUST DEVIL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("BLOWING DUST", "DUST STORM", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*drought.*", "DROUGHT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".+heat", "EXCESSIVE HEAT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("^heat.*", "HEAT", levels(subset$EVTYPE), ignore.case = T)
grep("heat", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("drought", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("wind", correct_event_types, ignore.case = T)
grep("wind", correct_event_types, ignore.case = T, value = T)
grep("wind", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("^tstm.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("wind", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("^tuderstorm.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("^thuderstorm.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("wind", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("wind", correct_event_types, ignore.case = T, value = T)
grep("chill", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*devil.*", "DUST DEVIL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("BLOWING DUST", "DUST STORM", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*drought.*", "DROUGHT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".+heat", "EXCESSIVE HEAT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("^heat.*", "HEAT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*chill.*", "COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
grep("wind", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("wind", correct_event_types, ignore.case = T, value = T)
grep("microburst", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("micro", correct_event_types, ignore.case = T, value = T)
levels(subset$EVTYPE)<- gsub(".*microburst.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("snow", correct_event_types, ignore.case = T, value = T)
grep("snow", levels(subset$EVTYPE), value = T, ignore.case = T)
grep(".*lake.*snow.*", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("ice", correct_event_types, ignore.case = T, value = T)
grep("rain", correct_event_types, ignore.case = T, value = T)
levels(subset$EVTYPE)<- gsub(".*devil.*", "DUST DEVIL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("BLOWING DUST", "DUST STORM", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*drought.*", "DROUGHT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".+heat", "EXCESSIVE HEAT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("^heat.*", "HEAT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*chill.*", "COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*lake.*snow.*", "LAKE-EFFECT SNOW", levels(subset$EVTYPE), ignore.case = T)
grep("snow", levels(subset$EVTYPE), value = T, ignore.case = T)
grep(".*hea.*snow.*", levels(subset$EVTYPE), value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*hea.*snow.*", "HEAVY SNOW", levels(subset$EVTYPE), ignore.case = T)
grep("snow", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("!(lake)snow", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("!(lake).*snow", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("(?<!lake\\.)snow", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("(!lake)snow", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("snow", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("(?!.*lake)snow", levels(subset$EVTYPE), value = T, ignore.case = T)
grep("(?!.*lake)snow", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
correct_event_types
grep("sleet", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("seiche", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("wind", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*mircoburst.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep(".*high.*wind.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("(?!.*marine).*high.*wind.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("^(?!.*marine).*high.*wind.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("^(?!.*marine).*strong.*wind.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("^(?!.*marine).*high.*wind.*", "HIGH WIND", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("^(?!.*marine).*strong.*wind.*", "STRONG WIND", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*marine.*high.*wind.*", "HIGH WIND", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*marine.*strong.*wind.*", "STRONG WIND", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("^(?!.*marine).*high.*wind.*", "HIGH WIND", levels(subset$EVTYPE), ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("^(?!.*marine).*strong.*wind.*", "STRONG WIND", levels(subset$EVTYPE), ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*marine.*high.*wind.*", "HIGH WIND", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*marine.*strong.*wind.*", "STRONG WIND", levels(subset$EVTYPE), ignore.case = T)
grep("wind", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("(?!^thunderstorm).*strong.*wind.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("(?!^thunderstorm).*wind.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("(?!^thunder).*wind.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("^(?!thunder)(?!marine).*wind.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("^tunderstorm.*", "THUNDERSTORM WIND", levels(subset$EVTYPE), ignore.case = T)
grep("^(?!thunder)(?!marine)(?!strong)(?!high).*wind.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("^(?!thunder)(?!marine)(?!strong)(?!high).*wind.*(?!chill)$", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("^(?!thunder)(?!marine)(?!strong)(?!high).*wind.*(?!chill)", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("^(?!thunder)(?!marine)(?!strong)(?!high).*wind.*(?!chill)$", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*devil.*", "DUST DEVIL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("BLOWING DUST", "DUST STORM", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*drought.*", "DROUGHT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".+heat", "EXCESSIVE HEAT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("^heat.*", "HEAT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*chill.*", "COLD/WINKD CHILL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*lake.*snow.*", "LAKE-EFFECT SNOW", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*hea.*snow.*", "HEAVY SNOW", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*sleet.*", "SLEET", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("^(?!.*marine).*high.*wind.*", "HIGH WIND", levels(subset$EVTYPE), ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("^(?!.*marine).*strong.*wind.*", "STRONG WIND", levels(subset$EVTYPE), ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*marine.*high.*wind.*", "HIGH WIND", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*marine.*strong.*wind.*", "STRONG WIND", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("^(?!thunder)(?!marine)(?!strong)(?!high).*wind.*", "WIND", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("^(?!thunder)(?!marine)(?!strong)(?!high).*wind.*", "WIND", levels(subset$EVTYPE), ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("COLD/WINKD CHILL", "COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
grep("wind", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
subset <- droplevels(subset)
length(levels(subset$EVTYPE))
do_collect_garbage()
grep("snow", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("snow", correct_event_types, value = T, ignore.case = T)
grep("^(?!lake).*snow.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("(?!.*lake)snow", "HEAVY SNOW", levels(subset$EVTYPE), ignore.case = T, perl = T)
subset <- droplevels(subset)
do_collect_garbage()
length(levels(subset$EVTYPE))
grep("snow", correct_event_types, value = T, ignore.case = T)
grep(".*snow.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("(?!.*lake).*snow.*", "HEAVY SNOW", levels(subset$EVTYPE), ignore.case = T, perl = T)
grep(".*snow.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("lheavy snow.*", "LAKE-EFFECT SNOW", levels(subset$EVTYPE), ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("^(?!.*lake).*snow.*", "HEAVY SNOW", levels(subset$EVTYPE), ignore.case = T, perl = T)
grep(".*snow.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
subset <- droplevels(subset)
length(levels(subset$EVTYPE))
correct_event_types
grep(".*tsunami.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*t.*nami.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*hurricane.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*hurricane.*", "HURRICANE", levels(subset$EVTYPE), ignore.case = T)
grep(".*light.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*lightning.*", "LIGHTNING", levels(subset$EVTYPE), ignore.case = T)
grep(".*light.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*light.*ing.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*light.ing.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*light*ing.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*light+ing.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*lighting.*", "LIGHTNING", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*hurricane.*", "HURRICANE/TYPHOON", levels(subset$EVTYPE), ignore.case = T)
grep(".*typ.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*tip.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*typhoon.*", "HURRICANE/TYPHOON", levels(subset$EVTYPE), ignore.case = T)
subset <- droplevels(subset)
levels(subset$EVTYPE)
grep(".*fire.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*fire.*", correct_event_types, value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*fire.*", "WILDFIRE", levels(subset$EVTYPE), ignore.case = T)
correct_event_types
grep(".*rain.*", correct_event_types, value = T, ignore.case = T)
grep(".*rain.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*rain.*", "HEAVY RAIN", levels(subset$EVTYPE), ignore.case = T)
grep(".*FLD.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*volc.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*warm.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*lightning.*", "LIGHTNING", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*lighting.*", "LIGHTNING", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*fire.*", "WILDFIRE", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*rain.*", "HEAVY RAIN", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*fld.*", "FLOOD", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*warm.*", "HEAT", levels(subset$EVTYPE), ignore.case = T)
grep(".*storm.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*coast.*storm.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*fld.*", "FLOOD", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*warm.*", "HEAT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*coast.*storm.*", "COASTAL STORM", levels(subset$EVTYPE), ignore.case = T)
grep(".*fog.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*smoke.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*fog.*", "DENSE FOG", levels(subset$EVTYPE), ignore.case = T)
grep(".*freez.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*fre.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*coast.*storm.*", "COASTAL STORM", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*fog.*", "DENSE FOG", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*fre.*", "FROST/FREEZE", levels(subset$EVTYPE), ignore.case = T)
subset <- droplevels(subset)
length(levels(subset$EVTYPE))
levels(subset$EVTYPE)
grep("cold", correct_event_types, ignore.case = T)
grep("cold", correct_event_types, ignore.case = T, value = T)
grep(".*cold.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep("".*cold.*(?!.*freez)", "DENSE FOG"", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*cold.*(?!.*freez)", "DENSE FOG"", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
)
grep(".*cold.*(?!.*chill)", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*extreme.*cold.*(?!.*chill)", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*cold.*(?!.*chill)", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*extreme.*cold.*(?!.*chill)", "EXTREME COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*record.*cold.*(?!.*chill)", "EXTREME COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*extreme.*cold.*(?!.*chill)", "EXTREME COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*record.*cold.*(?!.*chill)", "EXTREME COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T, perl = T)
grep(".*cold.*(?!.*chill)", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*cold.*(?!chill)", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*cold.*(?!chill)$", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*cold.*(?!chillR)", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
grep(".*cold.*(?!chill$)", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("EXTREME COLD/WIND CHILL", "EXTREME COLKD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
grep(".*cold.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("EXTREME COLD/WIND CHILL", "EXTREME COLKD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*cold.*", "COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("EXTREME COLKD/WIND CHILL", "EXTREME COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
grep(".*cold.*", levels(subset$EVTYPE), value = T, ignore.case = T, perl = T)
subset <- droplevels(subset)
levels(subset$EVTYPE)
grep("surf", correct_event_types, ignore.case = T)
grep("surf", correct_event_types, ignore.case = T, value = T)
grep(".*surf.*", subset$EVTYPE, ignore.case = T, value = T)
grep(".*surf.*", levels(subset$EVTYPE), ignore.case = T, value = T)
grep(".*rip.*curr.*", levels(subset$EVTYPE), ignore.case = T, value = T)
grep("rip", correct_event_types, ignore.case = T, value = T)
grep("wint", correct_event_types, ignore.case = T, value = T)
grep(".*win.*", levels(subset$EVTYPE), ignore.case = T, value = T)
grep(".*wint.*", levels(subset$EVTYPE), ignore.case = T, value = T)
grep(".*wint.*we.*", levels(subset$EVTYPE), ignore.case = T, value = T)
levels(subset$EVTYPE)<- gsub(".*rip.*curr*", "RIP CURRENT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*wint.*we*", "WINTER WEATHER", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*wint.*mix*", "WINTER WEATHER", levels(subset$EVTYPE), ignore.case = T)
grep(".*surf.*", levels(subset$EVTYPE), ignore.case = T, value = T)
levels(subset$EVTYPE)<- gsub(".*rip.*curr*", "RIP CURRENT", levels(subset$EVTYPE), ignore.case = T)
grep(".*surf.*", levels(subset$EVTYPE), ignore.case = T, value = T)
levels(subset$EVTYPE)<- gsub(".*RIP.*CURR*", "RIP CURRENT", levels(subset$EVTYPE), ignore.case = T)
grep(".*surf.*", levels(subset$EVTYPE), ignore.case = T, value = T)
grep(".*rip.*", levels(subset$EVTYPE), ignore.case = T, value = T)
levels(subset$EVTYPE)<- gsub(".*rip.*curr.*", "RIP CURRENT", levels(subset$EVTYPE), ignore.case = T)
grep(".*surf.*", levels(subset$EVTYPE), ignore.case = T, value = T)
grep("surf", correct_event_types, value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*rip.*curr.*", "RIP CURRENT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*wint.*we.*", "WINTER WEATHER", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*wint.*mix.*", "WINTER WEATHER", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*surf.*", "HIGH SURF", levels(subset$EVTYPE), ignore.case = T)
# And I drop the unused ones.
subset <- droplevels(subset)
length(levels(subset$EVTYPE))
levels(subset$EVTYPE)
grep("hyp", correct_event_types, value = T, ignore.case = T)
grep(".*hup.*", levels(subset$EVTYPE), ignore.case = T, value = T)
grep(".*hyp.*", levels(subset$EVTYPE), ignore.case = T, value = T)
levels(subset$EVTYPE)<- gsub(".*extreme.*cold.*", "EXTREME COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*record.*cold.*", "EXTREME COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub(".*hyp.*", "EXTREME COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T, perl = T)
levels(subset$EVTYPE)<- gsub("EXTREME COLD/WIND CHILL", "EXTREME COLKD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*cold.*", "COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub("EXTREME COLKD/WIND CHILL", "EXTREME COLD/WIND CHILL", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*rip.*curr.*", "RIP CURRENT", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*wint.*we.*", "WINTER WEATHER", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*wint.*mix.*", "WINTER WEATHER", levels(subset$EVTYPE), ignore.case = T)
levels(subset$EVTYPE)<- gsub(".*surf.*", "HIGH SURF", levels(subset$EVTYPE), ignore.case = T)
# And I drop the unused ones.
subset <- droplevels(subset)
length(levels(subset$EVTYPE))
levels(subset$EVTYPE)
grep("^ic.*", levels(subset$EVTYPE), ignore.case = T, value = T)
grep("^ic.*(?!.*storm)", levels(subset$EVTYPE), ignore.case = T, value = T)
grep("^ic.*(?!.*storm)", levels(subset$EVTYPE), ignore.case = T, value = T, perl = T)
grep("^ic.*(?<storm)", levels(subset$EVTYPE), ignore.case = T, value = T, perl = T)
grep("^ic.*(?<!storm)", levels(subset$EVTYPE), ignore.case = T, value = T, perl = T)
grep("^ic.*(?<!storm)$", levels(subset$EVTYPE), ignore.case = T, value = T, perl = T)
grep("ice", correct_event_types, value = T, ignore.case = T)
levels(subset$EVTYPE)<- gsub("^ic.*(?<!storm)$", "ICE", levels(subset$EVTYPE), ignore.case = T, perl = T)
grep("^ic.*", levels(subset$EVTYPE), ignore.case = T, value = T)
subset <- droplevels(subset)
length(levels(subset$EVTYPE))
levels(subset$EVTYPE)
evtypes_dmg <- aggregate(x = (subset[, "PROPDMG"] + subset[, "CROPDMG"] + subset[, "INJURIES"] + subset[, "FATALITIES"]), by = list(subset[, "EVTYPE"]), FUN = "sum")
hhist(evtypes_dmg)
hist(evtypes_dmg)
hist(evtypes_dmg$x)
table(evtypes_dmg)
evtypes_dmg
